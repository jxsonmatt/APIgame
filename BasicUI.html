<!doctype html>
<html lang="en">
<head>
    <!-- Set up metadata, title, and global styles for the single-page game UI. -->
    <meta charset="utf-8" />
    <title>Minefield Gamble ‚Äî Basic UI</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Fullscreen modal that handles sign-in and sign-up before the game starts. -->
    <div id="authModal" class="modal auth-modal">
        <div class="modal-content">
            <h2 id="authTitle">Welcome to Minefield Gamble</h2>
            
            <!-- Container swaps between login and registration forms. -->
            <div id="authForms">
                <!-- Email/password login form shown by default. -->
                <form id="signInForm">
                    <div class="form-group">
                        <input type="email" id="signInEmail" required placeholder="Email ID">
                    </div>
                    <div class="form-group">
                        <input type="password" id="signInPassword" required placeholder="Password">
                    </div>
                    <div class="form-options">
                        <label class="remember-me">
                            <input type="checkbox" id="rememberMe">
                            <span>Remember me</span>
                        </label>
                        <a href="#" class="forgot-password">Forgot Password?</a>
                    </div>
                    <div class="btn-row">
                        <button type="submit" class="primary">LOGIN</button>
                        <button type="button" id="showSignUp">Create New Account</button>
                    </div>
                </form>

                <!-- Registration form revealed when players choose to create a new account. -->
                <form id="signUpForm" style="display: none;">
                    <div class="form-group">
                        <label for="signUpUsername">Choose a Username</label>
                        <input type="text" id="signUpUsername" required placeholder="Enter a username">
                    </div>
                    <div class="form-group">
                        <label for="signUpEmail">Email Address</label>
                        <input type="email" id="signUpEmail" required placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="signUpPassword">Password</label>
                        <input type="password" id="signUpPassword" required minlength="6" 
                               placeholder="At least 6 characters">
                    </div>
                    <div class="btn-row">
                        <button type="submit" class="primary">Create Account</button>
                        <button type="button" id="showSignIn">Back to Sign In</button>
                    </div>
                </form>
            </div>

            <!-- Inline error surface for authentication issues. -->
            <p id="authError"></p>
        </div>
    </div>

    <div class="wrap">
        <header>
            <div>
                <h1>Minefield Gamble ‚Äî Basic UI</h1>
                <div class="muted">Click squares to uncover. Mines lose the round. Cash out winnings while you can.</div>
            </div>
            <!-- Signed-in player badge with a one-click sign-out control. -->
            <div id="userInfo" style="text-align: right; margin-bottom: 10px;">
                <span id="currentUsername"></span>
                <button id="signOut" class="small">Sign Out</button>
            </div>

            <div class="controls">
                <div class="panel">
                    <div>
                        <div class="muted">Balance</div>
                        <div id="balance" class="balance">--</div>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="game-layout">
                <div class="game-container">
                    <div class="board-wrap">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                            <!-- Left cluster: board size and mine density controls. -->
                            <div style="display:flex;gap:8px;align-items:center">
                                <label class="muted">Grid</label>
                                <select id="gridSize">
                                    <option value="5">5 √ó 5</option>
                                    <option value="6">6 √ó 6</option>
                                    <option value="7">7 √ó 7</option>
                                </select>
                                <label class="muted">Mines</label>
                                <input id="mineCount" type="number" min="1" max="20" value="5" style="width:72px">
                            </div>

                            <!-- Right cluster: bet amount and round actions. -->
                            <div style="display:flex;gap:8px;align-items:center">
                                <label class="muted">Bet</label>
                                <input id="betAmount" type="number" min="1" value="10" style="width:100px">
                                <button id="startRound" class="primary game-button">Start Round</button>
                                <button id="cashOut" class="game-button" disabled>Cash Out</button>
                            </div>
                        </div>

                        <div id="info" style="display:flex;gap:18px;margin-bottom:12px">
                            <!-- Heads-up display with live round stats. -->
                            <div>
                                <div class="muted">Picked</div>
                                <div id="pickedCount" class="big">0</div>
                            </div>
                            <div>
                                <div class="muted">Potential Payout</div>
                                <div id="payout" class="big">0</div>
                            </div>
                            <div>
                                <div class="muted">Round</div>
                                <div id="roundStatus" class="big">Idle</div>
                            </div>
                        </div>

                        <div id="grid" class="grid"></div>
                    </div>
                </div>

                <!-- Vertical button column for utility actions beside the board. -->
                <div class="vertical-actions">
                    <button id="revealAll" class="game-button action-button">REVEAL ALL</button>
                    <button id="newBoard" class="game-button action-button highlight">CLEAR BOARD</button>
                    <button id="tryBanana" class="game-button action-button">üçå PLAY CHALLENGE</button>
                </div>

                <!-- Hidden div that the script uses as an activity log feed. -->
                <div id="log" style="display:none"></div>
            </div>
        </main>
    </div>

    <!-- Banana Challenge modal appears when bankroll hits zero or the button is pressed. -->
    <div id="bananaModal" class="modal">
        <!-- Modal content wrapper - centers content and provides styling -->
        <div class="modal-content">
            <!-- Challenge title and explanation -->
            <h2>Earn $100 - Solve the Challenge!</h2>
            <p>You're out of money! Solve this challenge to earn $100.</p>
            
            <!-- Main challenge container -->
            <div id="bananaChallenge">
                <!-- Dynamic image loaded from Banana API -->
                <!-- src is empty initially, filled by JavaScript when modal opens -->
                <img id="bananaImage" src="" alt="Banana Challenge">
                
                <!-- User input section -->
                <p>What's the correct answer?</p>
                <!-- Numeric input restricted to single digits 0-9 -->
                <input type="number" id="bananaAnswer" min="0" max="9">
                
                <!-- Result message container - shows success/failure messages -->
                <!-- Style margin adds space between input and message -->
                <p id="bananaResult" style="margin-top:10px;"></p>
                
                <!-- Action buttons container -->
                <div class="btn-row">
                    <!-- Submit button triggers answer validation -->
                    <button class="primary" id="submitBanana">Submit Answer</button>
                    <!-- Skip button closes modal without reward -->
                    <button id="skipBanana">Skip</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase App Configuration -->
    <!-- Lightweight bootstrap so Firebase is initialized even before the module loads. -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBQieeHbz8glgWcp8_BDdoNFGGnBjodbRk",
            authDomain: "apigame-34134.firebaseapp.com",
            projectId: "apigame-34134",
            storageBucket: "apigame-34134.firebasestorage.app",
            messagingSenderId: "648910176965",
            appId: "1:648910176965:web:d93bf1f3348d9c3d60a6ac",
            measurementId: "G-WYL7L5K6C7"
        };

        // Initialize Firebase
        try {
            const app = initializeApp(firebaseConfig);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }
    </script>
    
    <!-- Main application script -->
    <script type="module" src="script.js"></script>
</body>
</html>
